services:
  testing:
    image: pollenrobotics/reachy2_testing:latest
    container_name: reachy2_testing
    privileged: true
    environment:
      - ROS_DOMAIN_ID=$ROS_DOMAIN_ID
      - DISPLAY=$DISPLAY
    volumes:
      - /dev:/dev
      # - package:/package
      - $HOME/.reachy_config:/home/reachy/.reachy_config_override
      - $HOME/.reachy.log:/home/reachy/.ros/log
    group_add:
      - audio
    # allow interprocess comunication to handle alsa audio concurrent access
    ipc: host
    device_cgroup_rules:
      - 'c 189:* rmw' # rules for usb cam
    network_mode: "host"
    entrypoint: ["/package/launch_mb_test.sh"]